/*! Store Map - v0.1.1
 * http://wordpress.org/plugins
 * Copyright (c) 2016; * Licensed GPLv2+ */
function CoordonateFromAdress(){function a(a){f.push(a),g||b()}function b(){var a=f.pop();null!=a?(g=!0,d(a,c)):g=!1}function c(a,c){setTimeout(b,e.delay),a.callback(c)}function d(a,b){h.geocode({address:a.adresse},function(c,d){if(d===google.maps.GeocoderStatus.OK){var e=c[0].geometry.location;b(a,e)}else console.log("Probléme pour détecter l'adresse: "+a.adresse),console.log("Statut: "+d),b(a,null)})}var e=this;this.delay=1e3;var f=[],g=!1,h=new google.maps.Geocoder;this.find=function(b,c){var d={};d.adresse=b,d.callback=c,a(d)}}jQuery(document).ready(function(a){function b(a){c(a,function(){e(a)})}function c(a,b){h.find(a.adresse,function(c){null!=c?a.gpsData={lat:c.lat(),lng:c.lng()}:a.gpsData={lat:0,lng:0},b()})}function d(a){g={};for(var b in a){var c={};c.titre=a[b][0],c.adresse=a[b][1],c.iconeUrl=a[b][2],c.detailDescription={};for(var d=3;d<a[b].length;d++)c.detailDescription[d]=a[b][d];g[b]=c}}function e(a){var b='<div class="titreStore"><h3>'+a.titre+"</h3></div>";b+='<div class="adresse">'+a.adresse+"</div>",b+='<div class="gps">'+JSON.stringify(a.gpsData,null,2)+"</div>",b+='<div class="iconeURL">'+a.iconeUrl+"</div>",b+='<div class="description">'+f(a.detailDescription)+"</div>";var c={"class":"store_map_info_store",html:b};jQuery("<div/>",c).appendTo("#feedback")}function f(a){var b="";for(var c in a)b+="<p>"+a[c]+"</p>";return b}var g={},h=new CoordonateFromAdress;a("#input_file_field").change(function(){var a=document.getElementById("input_file_field").files[0];Papa.parse(a,{delimiter:";",complete:function(a){d(a.data);for(var c in g)b(g[c])}})}),a("#bouton_envoyer").click(function(){var a={action:"store_map_import_cvs",store_data:g};jQuery.post(ajax_object.ajax_url,a,function(a){alert("Got this from the server: "+a)})})});