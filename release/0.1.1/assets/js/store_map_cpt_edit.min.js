/*! Store Map - v0.1.1
 * http://wordpress.org/plugins
 * Copyright (c) 2016; * Licensed GPLv2+ */
function Store_Map_Google_Map_Vue(a){function b(a){google.maps.event.addListener(a,"domready",function(){a.setZIndex(d++)})}var c=this,d=1,e=new google.maps.LatLngBounds,f=[],g={zoom:9,center:new google.maps.LatLng(46.34,-72.54),scrollwheel:!1,styles:[{featureType:"all",stylers:[{saturation:-50}]}]};this.map=new google.maps.Map(document.getElementById(a),g),this.openInfoWindow=[],this.centerMapByAdress=function(a){c.getCoordonateFromAdress(a,function(a){c.centerMapByCoordonate(a)})},this.clearAllMarkers=function(){for(var a in f)f[a].setMap(null);f=[]},this.centerMapByCoordonate=function(a,b){"undefined"!==b&&c.map.setZoom(b),c.map.setCenter(a)},this.setVueOnMarkUp=function(a,b){c.map.panTo(a.getPosition()),"undefined"!=typeof b&&c.map.setZoom(b)},this.addMarkUp=function(a,d,g,h){""===d&&"undefined"!=typeof store_map_options.marker_icone_url&&(d=store_map_options.marker_icone_url);var i=new google.maps.Marker({position:a,map:c.map,icon:d});if(i.setMap(c.map),"undefined"!=typeof g){var j=new google.maps.InfoWindow({content:g});i.infowindow=j,i.addListener("click",function(){j.open(c.map,i),h()}),b(j)}return e.extend(a),c.map.fitBounds(e),f.push(i),i},this.addMarkUpByAdresse=function(a){c.getCoordonateFromAdress(a,function(a){c.addMarkUp(a),c.centerMapByCoordonate(a,13)})},this.addMarkUpByCoordonate=function(a,b){var d=new google.maps.LatLng(a,b);console.log(a+" + "+b),c.addMarkUp(d),c.centerMapByCoordonate(d,13)},this.fitBounds=function(a){var b=new google.maps.LatLngBounds;for(var d in a)b.extend(a[d]);c.map.fitBounds(b)},this.getCoordonateFromAdress=function(a,b){var c=new google.maps.Geocoder;c.geocode({address:a},function(a,c){if(c===google.maps.GeocoderStatus.OK){var d=a[0].geometry.location;b(d)}else alert("Geocode was not successful for the following reason: "+c)})}}function CoordonateFromAdress(){function a(a){f.push(a),g||b()}function b(){var a=f.pop();null!=a?(g=!0,d(a,c)):g=!1}function c(a,c){setTimeout(b,e.delay),a.callback(c)}function d(a,b){h.geocode({address:a.adresse},function(c,d){if(d===google.maps.GeocoderStatus.OK){var e=c[0].geometry.location;b(a,e)}else console.log("Probléme pour détecter l'adresse: "+a.adresse),console.log("Statut: "+d),b(a,null)})}var e=this;this.delay=1e3;var f=[],g=!1,h=new google.maps.Geocoder;this.find=function(b,c){var d={};d.adresse=b,d.callback=c,a(d)}}jQuery(document).ready(function(a){function b(a,b){c.clearAllMarkers(),c.addMarkUpByCoordonate(a,b)}var c=new Store_Map_Google_Map_Vue("store_map_map"),d=new CoordonateFromAdress,e=a("#store_map_lat"),f=a("#store_map_lng");null!=e.val()&&null!=f.val()&&b(e.val(),f.val()),a("#store_map_trouver").click(function(){var c=a("#store_map_store_adresse").val();d.find(c,function(c){a("#store_map_lat").val(c.lat()),a("#store_map_lng").val(c.lng()),b(c.lat(),c.lng())})}),a("#publish").click(function(){})});